#include "GAMER.h"

#if ( MODEL == ELBDM )

#include <complex.h>

#define flag_spectral_float double
typedef std::complex<real>                complex_type;
typedef std::complex<flag_spectral_float> flag_spectral_complex_type;


// GramFE parameters for extension of size 14
#define FLAG_SPECTRAL_ORDER   14
#define FLAG_SPECTRAL_NDELTA  14
#define FLAG_SPECTRAL_ND      32
#define FLAG_SPECTRAL_FLU_NXT (FLU_NXT + FLAG_SPECTRAL_ND)

// GramFE arrays in case WAVE_SCHEME != WAVE_GRAMFE
const static flag_spectral_float  Flag_Spectral_Fe[FLAG_SPECTRAL_NDELTA][FLAG_SPECTRAL_ND] = {
{0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000},
{0.4972451580988168640118374241865240037441253662109375000000000000, 0.5635445124964545415835459607478696852922439575195312500000000000, 0.6298438654767427591352202398411463946104049682617187500000000000, 0.6961431685927198520502656720054801553487777709960937500000000000, 0.7624415493218033024191981894546188414096832275390625000000000000, 0.8287293691131502049174173407664056867361068725585937500000000000, 0.8949346515868616958044867715216241776943206787109375000000000000, 0.9606707594233995228805156330054160207509994506835937500000000000, 1.0243815859423439640352171409176662564277648925781250000000000000, 1.0812526342835442338952134377905167639255523681640625000000000000, 1.1196842065391943155105991536402143537998199462890625000000000000, 1.1179479743681164372048897348577156662940979003906250000000000000, 1.0452207219461098208768135009449906647205352783203125000000000000, 0.8713756459943589049998990958556532859802246093750000000000000000, 0.5845290122238061547577103738149162381887435913085937500000000000, 0.2065689464178071810263048746492131613194942474365234375000000000, -0.2065689464178050993581337024806998670101165771484375000000000000, -0.5845290122238043784008709735644515603780746459960937500000000000, -0.8713756459943577947768744706991128623485565185546875000000000000, -1.0452207219461091547429987258510664105415344238281250000000000000, -1.1179479743681162151602848098264075815677642822265625000000000000, -1.1196842065391943155105991536402143537998199462890625000000000000, -1.0812526342835444559398183628218248486518859863281250000000000000, -1.0243815859423432979014023658237420022487640380859375000000000000, -0.9606707594233994118582131704897619783878326416015625000000000000, -0.8949346515868615847821843090059701353311538696289062500000000000, -0.8287293691131499828728124157350976020097732543945312500000000000, -0.7624415493218036354861055770015809684991836547851562500000000000, -0.6961431685927201851171730595524422824382781982421875000000000000, -0.6298438654767430922021276273881085216999053955078125000000000000, -0.5635445124964548746504533482948318123817443847656250000000000000, -0.4972451580988171970787448117334861308336257934570312500000000000},
{0.7412493166610979455910523938655387610197067260742187500000000000, 1.0377490433235605493678122002165764570236206054687500000000000000, 1.3713112356007948200442569941515102982521057128906250000000000000, 1.7419358846345796010268713871482759714126586914062500000000000000, 2.1496228036120115234552940819412469863891601562500000000000000000, 2.5943695898027305801747388613875955343246459960937500000000000000, 3.0761553762774020981396461138501763343811035156250000000000000000, 3.5948493953383517940380897925933822989463806152343750000000000000, 4.1498328470591312466808631143067032098770141601562500000000000000, 4.7388232874147355744298693025484681129455566406250000000000000000, 5.3551122666149080231434709276072680950164794921875000000000000000, 5.9827619454316769420643140620086342096328735351562500000000000000, 6.5909481329490731127407343592494726181030273437500000000000000000, 7.1312145139701685891964189067948609590530395507812500000000000000, 7.5425876384660766049705671321135014295578002929687500000000000000, 7.7664825689683834042398302699439227581024169921875000000000000000, 7.7664825689683834042398302699439227581024169921875000000000000000, 7.5425876384660783813274065323639661073684692382812500000000000000, 7.1312145139701712537316780071705579757690429687500000000000000000, 6.5909481329490757772759934596251696348190307617187500000000000000, 5.9827619454316796065995731623843312263488769531250000000000000000, 5.3551122666149115758571497281081974506378173828125000000000000000, 4.7388232874147382389651284029241651296615600585937500000000000000, 4.1498328470591250294319252134300768375396728515625000000000000000, 3.5948493953383504617704602424055337905883789062500000000000000000, 3.0761553762774007658720165636623278260231018066406250000000000000, 2.5943695898027292479071093111997470259666442871093750000000000000, 2.1496228036120132998121334821917116641998291015625000000000000000, 1.7419358846345815994283157124300487339496612548828125000000000000, 1.3713112356007965964010963944019749760627746582031250000000000000, 1.0377490433235621036800466754357330501079559326171875000000000000, 0.7412493166610992778586819440533872693777084350585937500000000000},
{1.0903261845927807449641022685682401061058044433593750000000000000, 1.9625871316647474085215208106092177331447601318359375000000000000, 3.1074295698613312310953915584832429885864257812500000000000000000, 4.5569200348950120726954082783777266740798950195312500000000000000, 6.3430930430347514104028050496708601713180541992187500000000000000, 8.4976422906305959514838832546956837177276611328125000000000000000, 11.0498357216937801439371469314210116863250732421875000000000000000, 14.0166821651410309357288497267290949821472167968750000000000000000, 17.3695479450742951144093240145593881607055664062500000000000000000, 20.9522785007080294406023313058540225028991699218750000000000000000, 24.3418973615075238114968669833615422248840332031250000000000000000, 26.7131388876848454572154878405854105949401855468750000000000000000, 26.8680748020966895239780569681897759437561035156250000000000000000, 23.6014667116856138306957291206344962120056152343750000000000000000, 16.3676676970339407546362053835764527320861816406250000000000000000, 5.8779903299131035510072251781821250915527343750000000000000000000, -5.8779903299130449312315249699167907238006591796875000000000000000, -16.3676676970338945693583809770643711090087890625000000000000000000, -23.6014667116855854089862987166270613670349121093750000000000000000, -26.8680748020966788658370205666869878768920898437500000000000000000, -26.7131388876848525626428454415872693061828613281250000000000000000, -24.3418973615075380223515821853652596473693847656250000000000000000, -20.9522785007080472041707253083586692810058593750000000000000000000, -17.3695479450742595872725360095500946044921875000000000000000000000, -14.0166821651410238303014921257272362709045410156250000000000000000, -11.0498357216937730385097893304191529750823974609375000000000000000, -8.4976422906305906224133650539442896842956542968750000000000000000, -6.3430930430347611803654217510484158992767333984375000000000000000, -4.5569200348950200663011855795048177242279052734375000000000000000, -3.1074295698613378924335393094224855303764343261718750000000000000, -1.9625871316647522935028291612979955971240997314453125000000000000, -1.0903261845927842976777810690691694617271423339843750000000000000},
{1.6586888651124156446314827917376533150672912597656250000000000000, 3.8702740184306767545763250382151454687118530273437500000000000000, 7.3258758023332335440613860555458813905715942382812500000000000000, 12.3669882423096915147198160411790013313293457031250000000000000000, 19.3730343372336051288584712892770767211914062500000000000000000000, 28.7611954429797194165985274594277143478393554687500000000000000000, 40.9850499625449202767413225956261157989501953125000000000000000000, 56.5269047371725150696875061839818954467773437500000000000000000000, 75.8660351358935969301455770619213581085205078125000000000000000000, 99.3797230237129838315013330429792404174804687500000000000000000000, 127.1098692786195982762365019880235195159912109375000000000000000000, 158.3543496321632346734986640512943267822265625000000000000000000000, 191.1775127541498875416436931118369102478027343750000000000000000000, 222.1489329315390932606533169746398925781250000000000000000000000000, 246.7216259101764137540158117190003395080566406250000000000000000000, 260.4164076053415328715345822274684906005859375000000000000000000000, 260.4164076053415897149534430354833602905273437500000000000000000000, 246.7216259101764990191441029310226440429687500000000000000000000000, 222.1489329315392353692004689946770668029785156250000000000000000000, 191.1775127541500580719002755358815193176269531250000000000000000000, 158.3543496321634052037552464753389358520507812500000000000000000000, 127.1098692786197403847836540080606937408447265625000000000000000000, 99.3797230237131117291937698610126972198486328125000000000000000000, 75.8660351358933979781795642338693141937255859375000000000000000000, 56.5269047371724724371233605779707431793212890625000000000000000000, 40.9850499625448847496045345906168222427368164062500000000000000000, 28.7611954429796945476027758559212088584899902343750000000000000000, 19.3730343372336477614226168952882289886474609375000000000000000000, 12.3669882423097199364292464451864361763000488281250000000000000000, 7.3258758023332539721650391584262251853942871093750000000000000000, 3.8702740184306905213418303901562467217445373535156250000000000000, 1.6586888651124240823264699429273605346679687500000000000000000000},
{2.6643763057504563640520700573688372969627380371093750000000000000, 7.9931288923631385046064679045230150222778320312500000000000000000, 17.9845377332973370698709913995116949081420898437500000000000000000, 34.8327170161178685248160036280751228332519531250000000000000000000, 61.2789987916413778634705522563308477401733398437500000000000000000, 100.6568230470223426209486206062138080596923828125000000000000000000, 156.8624990826565124280023155733942985534667968750000000000000000000, 234.0012804810351099149556830525398254394531250000000000000000000000, 335.0399666663535072075319476425647735595703125000000000000000000000, 458.3861967312373053573537617921829223632812500000000000000000000000, 591.9139678405787208248511888086795806884765625000000000000000000000, 706.7897125457258198366616852581501007080078125000000000000000000000, 757.6070309371056055169901810586452484130859375000000000000000000000, 695.9461235629166822036495432257652282714843750000000000000000000000, 496.4217673985044712026137858629226684570312500000000000000000000000, 180.7052272685575076138775330036878585815429687500000000000000000000, -180.7052272685556886244739871472120285034179687500000000000000000000, -496.4217673985031069605611264705657958984375000000000000000000000000, -695.9461235629158863957854919135570526123046875000000000000000000000, -757.6070309371054918301524594426155090332031250000000000000000000000, -706.7897125457262745840125717222690582275390625000000000000000000000, -591.9139678405794029458775185048580169677734375000000000000000000000, -458.3861967312379306349612306803464889526367187500000000000000000000, -335.0399666663523703391547314822673797607421875000000000000000000000, -234.0012804810348825412802398204803466796875000000000000000000000000, -156.8624990826563703194551635533571243286132812500000000000000000000, -100.6568230470222289341108989901840686798095703125000000000000000000, -61.2789987916415341828724194783717393875122070312500000000000000000, -34.8327170161179680007990100421011447906494140625000000000000000000, -17.9845377332974010187172098085284233093261718750000000000000000000, -7.9931288923631740317432559095323085784912109375000000000000000000, -2.6643763057504741276204640598734840750694274902343750000000000000},
{4.5797408195085784754496671666856855154037475585937500000000000000, 17.4030151031876911815743369515985250473022460937500000000000000000, 46.2553810407961165651613555382937192916870117187500000000000000000, 102.4514430820580344061454525217413902282714843750000000000000000000, 202.0192520523129928733396809548139572143554687500000000000000000000, 366.7806776861552293667045887559652328491210937500000000000000000000, 625.4612774375439130380982533097267150878906250000000000000000000000, 1014.4860160315330404046108014881610870361328125000000000000000000000, 1577.2600699853442165476735681295394897460937500000000000000000000000, 2358.9957480390448836260475218296051025390625000000000000000000000000, 3392.3975715721630876942072063684463500976562500000000000000000000000, 4670.9899454002861602930352091789245605468750000000000000000000000000, 6115.5069675125878347898833453655242919921875000000000000000000000000, 7552.8911022810389113146811723709106445312500000000000000000000000000, 8734.7213495332489401334896683692932128906250000000000000000000000000, 9406.9382288125907507492229342460632324218750000000000000000000000000, 9406.9382288125925697386264801025390625000000000000000000000000000000, 8734.7213495332543971017003059387207031250000000000000000000000000000, 7552.8911022810461872722953557968139648437500000000000000000000000000, 6115.5069675125951107474975287914276123046875000000000000000000000000, 4670.9899454002934362506493926048278808593750000000000000000000000000, 3392.3975715721685446624178439378738403320312500000000000000000000000, 2358.9957480390489763522055000066757202148437500000000000000000000000, 1577.2600699853376227110857143998146057128906250000000000000000000000, 1014.4860160315319035362335853278636932373046875000000000000000000000, 625.4612774375431172302342019975185394287109375000000000000000000000, 366.7806776861547746193537022918462753295898437500000000000000000000, 202.0192520523136181509471498429775238037109375000000000000000000000, 102.4514430820584038883680477738380432128906250000000000000000000000, 46.2553810407963155171273683663457632064819335937500000000000000000, 17.4030151031877871048436645651236176490783691406250000000000000000, 4.5797408195086157789432945719454437494277954101562500000000000000},
{8.5207040533845592733541707275435328483581542968750000000000000000, 40.3313313988891479766607517376542091369628906250000000000000000000, 125.8222911352476955926249502226710319519042968750000000000000000000, 317.6179247221231207731761969625949859619140625000000000000000000000, 700.4436609266949744778685271739959716796875000000000000000000000000, 1402.7282088375079638353781774640083312988281250000000000000000000000, 2607.4539047949970154149923473596572875976562500000000000000000000000, 4550.9377051906994893215596675872802734375000000000000000000000000000, 7478.4513097098151774844154715538024902343750000000000000000000000000, 11504.4216506770226260414347052574157714843750000000000000000000000000, 16346.7548173943705478450283408164978027343750000000000000000000000000, 21026.5157669483305653557181358337402343750000000000000000000000000000, 23811.2767926607193658128380775451660156250000000000000000000000000000, 22722.9485505881639255676418542861938476562500000000000000000000000000, 16598.9457422758605389390140771865844726562500000000000000000000000000, 6111.6053136290674956399016082286834716796875000000000000000000000000, -6111.6053136290047405054792761802673339843750000000000000000000000000, -16598.9457422758132452145218849182128906250000000000000000000000000000, -22722.9485505881457356736063957214355468750000000000000000000000000000, -23811.2767926607230037916451692581176757812500000000000000000000000000, -21026.5157669483487552497535943984985351562500000000000000000000000000, -16346.7548173943941947072744369506835937500000000000000000000000000000, -11504.4216506770444539142772555351257324218750000000000000000000000000, -7478.4513097097815261804498732089996337890625000000000000000000000000, -4550.9377051906940323533490300178527832031250000000000000000000000000, -2607.4539047949933774361852556467056274414062500000000000000000000000, -1402.7282088375056900986237451434135437011718750000000000000000000000, -700.4436609266974755882984027266502380371093750000000000000000000000, -317.6179247221244281718099955469369888305664062500000000000000000000, -125.8222911352483208702324191108345985412597656250000000000000000000, -40.3313313988894037720456253737211227416992187500000000000000000000, -8.5207040533846409857687831390649080276489257812500000000000000000},
{17.3696084200167817357396415900439023971557617187500000000000000000, 100.7437281090508349734591320157051086425781250000000000000000000000, 366.4986552094689500336244236677885055541992187500000000000000000000, 1050.6534197930645859742071479558944702148437500000000000000000000000, 2585.8458807236615939473267644643783569335937500000000000000000000000, 5708.2275459743495957809500396251678466796875000000000000000000000000, 11596.6717412422622146550565958023071289062500000000000000000000000000, 22028.6912518389217439107596874237060546875000000000000000000000000000, 39479.3200961729744449257850646972656250000000000000000000000000000000, 66967.7187547629291657358407974243164062500000000000000000000000000000, 107323.0367582164617488160729408264160156250000000000000000000000000000, 161605.3422728171863127499818801879882812500000000000000000000000000000, 226947.3511299503443296998739242553710937500000000000000000000000000000, 294997.3585072067799046635627746582031250000000000000000000000000000000, 352669.3257235756609588861465454101562500000000000000000000000000000000, 386042.6118838042020797729492187500000000000000000000000000000000000000, 386042.6118838043184950947761535644531250000000000000000000000000000000, 352669.3257235758937895298004150390625000000000000000000000000000000000, 294997.3585072070709429681301116943359375000000000000000000000000000000, 226947.3511299506935756653547286987304687500000000000000000000000000000, 161605.3422728174773510545492172241210937500000000000000000000000000000, 107323.0367582166945794597268104553222656250000000000000000000000000000, 66967.7187547630892368033528327941894531250000000000000000000000000000, 39479.3200961727561661973595619201660156250000000000000000000000000000, 22028.6912518388890021014958620071411132812500000000000000000000000000, 11596.6717412422422057716175913810729980468750000000000000000000000000, 5708.2275459743386818445287644863128662109375000000000000000000000000, 2585.8458807236720531363971531391143798828125000000000000000000000000, 1050.6534197930693608213914558291435241699218750000000000000000000000, 366.4986552094710532401222735643386840820312500000000000000000000000, 100.7437281090515597270496073178946971893310546875000000000000000000, 17.3696084200169664768509392160922288894653320312500000000000000000},
{39.3841323506540916810081398580223321914672851562500000000000000000, 275.6888670807454673195024952292442321777343750000000000000000000000, 1161.8262864458420153823681175708770751953125000000000000000000000000, 3767.9290552943343755032401531934738159179687500000000000000000000000, 10320.4059230616294371429830789566040039062500000000000000000000000000, 25024.7818671002787596080452203750610351562500000000000000000000000000, 55131.5922246232512407004833221435546875000000000000000000000000000000, 111748.5153049920481862500309944152832031250000000000000000000000000000, 208803.2093095538148190826177597045898437500000000000000000000000000000, 357243.9262506763334386050701141357421875000000000000000000000000000000, 552293.3730319048045203089714050292968750000000000000000000000000000000, 757462.0712993162451311945915222167968750000000000000000000000000000000, 898751.3073385710595175623893737792968750000000000000000000000000000000, 885638.0905913388123735785484313964843750000000000000000000000000000000, 660001.5647690498735755681991577148437500000000000000000000000000000000, 245340.9812000134843401610851287841796875000000000000000000000000000000, -245340.9812000109232030808925628662109375000000000000000000000000000000, -660001.5647690480109304189682006835937500000000000000000000000000000000, -885638.0905913379974663257598876953125000000000000000000000000000000000, -898751.3073385712923482060432434082031250000000000000000000000000000000, -757462.0712993170600384473800659179687500000000000000000000000000000000, -552293.3730319058522582054138183593750000000000000000000000000000000000, -357243.9262506772065535187721252441406250000000000000000000000000000000, -208803.2093095526215620338916778564453125000000000000000000000000000000, -111748.5153049918735632672905921936035156250000000000000000000000000000, -55131.5922246231493772938847541809082031250000000000000000000000000000, -25024.7818671002278279047459363937377929687500000000000000000000000000, -10320.4059230616767308674752712249755859375000000000000000000000000000, -3767.9290552943543843866791576147079467773437500000000000000000000000, -1161.8262864458492913399823009967803955078125000000000000000000000000, -275.6888670807476842128380667418241500854492187500000000000000000000, -39.3841323506545535337863839231431484222412109375000000000000000000},
{101.4214359723431044812969048507511615753173828125000000000000000000, 845.1785763828128210661816410720348358154296875000000000000000000000, 4099.1099037706726448959670960903167724609375000000000000000000000000, 14981.7558001408651762176305055618286132812500000000000000000000000000, 45573.6725967859092634171247482299804687500000000000000000000000000000, 121457.4746004045446170493960380554199218750000000000000000000000000000, 292230.9308080415357835590839385986328125000000000000000000000000000000, 646156.7099880970781669020652770996093750000000000000000000000000000000, 1324918.7226209619548171758651733398437500000000000000000000000000000000, 2524840.1223902180790901184082031250000000000000000000000000000000000000, 4459109.2543100239709019660949707031250000000000000000000000000000000000, 7257033.2378837084397673606872558593750000000000000000000000000000000000, 10812375.3251392561942338943481445312500000000000000000000000000000000000, 14660193.3108061514794826507568359375000000000000000000000000000000000000, 18005136.1064570806920528411865234375000000000000000000000000000000000000, 19968880.4627807699143886566162109375000000000000000000000000000000000000, 19968880.4627807773649692535400390625000000000000000000000000000000000000, 18005136.1064570918679237365722656250000000000000000000000000000000000000, 14660193.3108061701059341430664062500000000000000000000000000000000000000, 10812375.3251392748206853866577148437500000000000000000000000000000000000, 7257033.2378837242722511291503906250000000000000000000000000000000000000, 4459109.2543100351467728614807128906250000000000000000000000000000000000, 2524840.1223902255296707153320312500000000000000000000000000000000000000, 1324918.7226209533400833606719970703125000000000000000000000000000000000, 646156.7099880959140136837959289550781250000000000000000000000000000000, 292230.9308080408954992890357971191406250000000000000000000000000000000, 121457.4746004042681306600570678710937500000000000000000000000000000000, 45573.6725967861420940607786178588867187500000000000000000000000000000, 14981.7558001409524877090007066726684570312500000000000000000000000000, 4099.1099037707008392317220568656921386718750000000000000000000000000, 845.1785763828200970237958244979381561279296875000000000000000000000, 101.4214359723443976690759882330894470214843750000000000000000000000},
{306.4032667687906155151722487062215805053710937500000000000000000000, 3002.7477102213788384688086807727813720703125000000000000000000000000, 16652.6072049617832817602902650833129882812500000000000000000000000000, 68304.7359582601638976484537124633789062500000000000000000000000000000, 229873.6052446980320382863283157348632812500000000000000000000000000000, 668976.0128762944368645548820495605468750000000000000000000000000000000, 1731170.9124560968484729528427124023437500000000000000000000000000000000, 4032715.4128163661807775497436523437500000000000000000000000000000000000, 8464929.1214928589761257171630859375000000000000000000000000000000000000, 15904006.2455074936151504516601562500000000000000000000000000000000000000, 26435959.2786025479435920715332031250000000000000000000000000000000000000, 38275039.0197164490818977355957031250000000000000000000000000000000000000, 47221850.0599275156855583190917968750000000000000000000000000000000000000, 47793060.1670813858509063720703125000000000000000000000000000000000000000, 36213337.4238204509019851684570312500000000000000000000000000000000000000, 13568974.2256679274141788482666015625000000000000000000000000000000000000, -13568974.2256677821278572082519531250000000000000000000000000000000000000, -36213337.4238203465938568115234375000000000000000000000000000000000000000, -47793060.1670813485980033874511718750000000000000000000000000000000000000, -47221850.0599275380373001098632812500000000000000000000000000000000000000, -38275039.0197165012359619140625000000000000000000000000000000000000000000, -26435959.2786026038229465484619140625000000000000000000000000000000000000, -15904006.2455075383186340332031250000000000000000000000000000000000000000, -8464929.1214928030967712402343750000000000000000000000000000000000000000, -4032715.4128163582645356655120849609375000000000000000000000000000000000, -1731170.9124560931231826543807983398437500000000000000000000000000000000, -668976.0128762928070500493049621582031250000000000000000000000000000000, -229873.6052446993126068264245986938476562500000000000000000000000000000, -68304.7359582605859031900763511657714843750000000000000000000000000000, -16652.6072049619069730397313833236694335937500000000000000000000000000, -3002.7477102214070328045636415481567382812500000000000000000000000000, -306.4032667687948219281679484993219375610351562500000000000000000000},
{1151.7843196715236899763112887740135192871093750000000000000000000000, 13130.3345094965716270962730050086975097656250000000000000000000000000, 82754.9303911599854473024606704711914062500000000000000000000000000000, 379543.9137811341206543147563934326171875000000000000000000000000000000, 1411483.5172486181836575269699096679687500000000000000000000000000000000, 4503146.1495193894952535629272460937500000000000000000000000000000000000, 12731360.2345652747899293899536132812500000000000000000000000000000000000, 32482177.1230255588889122009277343750000000000000000000000000000000000000, 75405884.3206322640180587768554687500000000000000000000000000000000000000, 159487208.7461148500442504882812500000000000000000000000000000000000000000, 306465829.0805852413177490234375000000000000000000000000000000000000000000, 532602859.8128819465637207031250000000000000000000000000000000000000000000, 833297044.1192231178283691406250000000000000000000000000000000000000000000, 1169315872.6587908267974853515625000000000000000000000000000000000000000000, 1467654059.7713315486907958984375000000000000000000000000000000000000000000, 1644912614.6239933967590332031250000000000000000000000000000000000000000000, 1644912614.6239938735961914062500000000000000000000000000000000000000000000, 1467654059.7713327407836914062500000000000000000000000000000000000000000000, 1169315872.6587922573089599609375000000000000000000000000000000000000000000, 833297044.1192246675491333007812500000000000000000000000000000000000000000, 532602859.8128832578659057617187500000000000000000000000000000000000000000, 306465829.0805861353874206542968750000000000000000000000000000000000000000, 159487208.7461153864860534667968750000000000000000000000000000000000000000, 75405884.3206316679716110229492187500000000000000000000000000000000000000, 32482177.1230254918336868286132812500000000000000000000000000000000000000, 12731360.2345652431249618530273437500000000000000000000000000000000000000, 4503146.1495193773880600929260253906250000000000000000000000000000000000, 1411483.5172486267983913421630859375000000000000000000000000000000000000, 379543.9137811367399990558624267578125000000000000000000000000000000000, 82754.9303911606548354029655456542968750000000000000000000000000000000, 13130.3345094967044133227318525314331054687500000000000000000000000000, 1151.7843196715402882546186447143554687500000000000000000000000000000},
{6219.6340821295989371719770133495330810546875000000000000000000000000, 81683.8636746142437914386391639709472656250000000000000000000000000000, 581575.5609138702275231480598449707031250000000000000000000000000000000, 2968631.2145206090062856674194335937500000000000000000000000000000000000, 12126798.6361967753618955612182617187500000000000000000000000000000000000, 41887615.7425941303372383117675781250000000000000000000000000000000000000, 125804263.9816877990961074829101562500000000000000000000000000000000000000, 332267972.7155719995498657226562500000000000000000000000000000000000000000, 772391222.1323263645172119140625000000000000000000000000000000000000000000, 1572070042.3147909641265869140625000000000000000000000000000000000000000000, 2776941931.6154375076293945312500000000000000000000000000000000000000000000, 4205351454.4021191596984863281250000000000000000000000000000000000000000000, 5358186832.4035100936889648437500000000000000000000000000000000000000000000, 5543824065.0001430511474609375000000000000000000000000000000000000000000000, 4258619318.7193574905395507812500000000000000000000000000000000000000000000, 1606206696.1600220203399658203125000000000000000000000000000000000000000000, -1606206696.1600039005279541015625000000000000000000000000000000000000000000, -4258619318.7193450927734375000000000000000000000000000000000000000000000000, -5543824065.0001382827758789062500000000000000000000000000000000000000000000, -5358186832.4035120010375976562500000000000000000000000000000000000000000000, -4205351454.4021253585815429687500000000000000000000000000000000000000000000, -2776941931.6154437065124511718750000000000000000000000000000000000000000000, -1572070042.3147959709167480468750000000000000000000000000000000000000000000, -772391222.1323205232620239257812500000000000000000000000000000000000000000, -332267972.7155712246894836425781250000000000000000000000000000000000000000, -125804263.9816874712705612182617187500000000000000000000000000000000000000, -41887615.7425940111279487609863281250000000000000000000000000000000000000, -12126798.6361968535929918289184570312500000000000000000000000000000000000, -2968631.2145206308923661708831787109375000000000000000000000000000000000, -581575.5609138752333819866180419921875000000000000000000000000000000000, -81683.8636746151169063523411750793457031250000000000000000000000000000, -6219.6340821296935246209613978862762451171875000000000000000000000000},
};

const static flag_spectral_float  Flag_Spectral_Fo[FLAG_SPECTRAL_NDELTA][FLAG_SPECTRAL_ND] = {
{0.2672612419124223981370391811651643365621566772460937500000000000, 0.2672612419111605741584014594991458579897880554199218750000000000, 0.2672612417766851988787379923451226204633712768554687500000000000, 0.2672612363731993179172263808140996843576431274414062500000000000, 0.2672611235294987674926403542485786601901054382324218750000000000, 0.2672596746387411181800075610226485878229141235351562500000000000, 0.2672470193587840325832871712918858975172042846679687500000000000, 0.2671666738409420593924892273207660764455795288085937500000000000, 0.2667784848784301998669832300947746261954307556152343750000000000, 0.2653032403015079254693375787610420957207679748535156250000000000, 0.2607845816197935095992477272375253960490226745605468750000000000, 0.2494240093690768544920643989826203323900699615478515625000000000, 0.2256565660625154956520077575987670570611953735351562500000000000, 0.1838564240092627199985031438700389117002487182617187500000000000, 0.1216006878631379073407714486165787093341350555419921875000000000, 0.0426878256011648735124275333419063827022910118103027343750000000, -0.0426878256011644433010054910937469685450196266174316406250000000, -0.1216006878631375465182884454407030716538429260253906250000000000, -0.1838564240092624424427469875809038057923316955566406250000000000, -0.2256565660625153568741296794541995041072368621826171875000000000, -0.2494240093690767712253375520958798006176948547363281250000000000, -0.2607845816197935095992477272375253960490226745605468750000000000, -0.2653032403015079254693375787610420957207679748535156250000000000, -0.2667784848784301998669832300947746261954307556152343750000000000, -0.2671666738409420593924892273207660764455795288085937500000000000, -0.2672470193587840325832871712918858975172042846679687500000000000, -0.2672596746387411181800075610226485878229141235351562500000000000, -0.2672611235294987674926403542485786601901054382324218750000000000, -0.2672612363731993179172263808140996843576431274414062500000000000, -0.2672612417766851988787379923451226204633712768554687500000000000, -0.2672612419111605741584014594991458579897880554199218750000000000, -0.2672612419124223981370391811651643365621566772460937500000000000},
{0.4972451580988467845223510721552884206175804138183593750000000000, 0.5635445125119571407878993341000750660896301269531250000000000000, 0.6298438669162346181806810818670783191919326782226562500000000000, 0.6961432209077362820437429036246612668037414550781250000000000000, 0.7624425650818629218719024720485322177410125732421875000000000000, 0.8287417678424109368506833561696112155914306640625000000000000000, 0.8950396003729904625956237396167125552892684936523437500000000000, 0.9613278642423844777553654239454772323369979858398437500000000000, 1.0275656071706440464197385153966024518013000488281250000000000000, 1.0935945767980368437122251634718850255012512207031250000000000000, 1.1589307765290683960301976185292005538940429687500000000000000000, 1.2223851162704639783385118789738044142723083496093750000000000000, 1.2815931590135101192373667799984104931354522705078125000000000000, 1.3327541571142202947442001459421589970588684082031250000000000000, 1.3710030911826538435605016275076195597648620605468750000000000000, 1.3916086821837017062364338926272466778755187988281250000000000000, 1.3916086821837017062364338926272466778755187988281250000000000000, 1.3710030911826540656051065525389276444911956787109375000000000000, 1.3327541571142205167888050709734670817852020263671875000000000000, 1.2815931590135103412819717050297185778617858886718750000000000000, 1.2223851162704642003831168040051124989986419677734375000000000000, 1.1589307765290686180748025435605086386203765869140625000000000000, 1.0935945767980372878014350135345011949539184570312500000000000000, 1.0275656071706433802859237403026781976222991943359375000000000000, 0.9613278642423843667330629614298231899738311767578125000000000000, 0.8950396003729903515733212771010585129261016845703125000000000000, 0.8287417678424108258283808936539571732282638549804687500000000000, 0.7624425650818632549388098595954943448305130004882812500000000000, 0.6961432209077366151106502911716233938932418823242187500000000000, 0.6298438669162349512475884694140404462814331054687500000000000000, 0.5635445125119574738548067216470371931791305541992187500000000000, 0.4972451580988470620781072284444235265254974365234375000000000000},
{0.7412493166610307770980625718948431313037872314453125000000000000, 1.0377490432811335985263667680555954575538635253906250000000000000, 1.3713112310530368720407068394706584513187408447265625000000000000, 1.7419356994802055460525025409879162907600402832031250000000000000, 2.1496188572815766448798058263491839170455932617187500000000000000, 2.5943175116539047841968113061739131808280944824218750000000000000, 3.0756845797231369132873624039348214864730834960937500000000000000, 3.5917332157672876569165509863523766398429870605468750000000000000, 4.1340121369936930761923576937988400459289550781250000000000000000, 4.6750819780011676485287352988962084054946899414062500000000000000, 5.1459811028376201136325107654556632041931152343750000000000000000, 5.4125821534104829879652243107557296752929687500000000000000000000, 5.2777246034287834675069461809471249580383300781250000000000000000, 4.5403870109705923852061459911055862903594970703125000000000000000, 3.1096164817416958037199492537183687090873718261718750000000000000, 1.1102791622622290024224867011071182787418365478515625000000000000, -1.1102791622622179001922404495417140424251556396484375000000000000, -3.1096164817416864778465424024034291505813598632812500000000000000, -4.5403870109705870561356277903541922569274902343750000000000000000, -5.2777246034287816911501067806966602802276611328125000000000000000, -5.4125821534104829879652243107557296752929687500000000000000000000, -5.1459811028376218899893501657061278820037841796875000000000000000, -4.6750819780011694248855746991466730833053588867187500000000000000, -4.1340121369936877471218394930474460124969482421875000000000000000, -3.5917332157672863246489214361645281314849853515625000000000000000, -3.0756845797231355810197328537469729781150817871093750000000000000, -2.5943175116539038960183916060486808419227600097656250000000000000, -2.1496188572815788653258550766622647643089294433593750000000000000, -1.7419356994802073224093419412383809685707092285156250000000000000, -1.3713112310530386483975462397211231291294097900390625000000000000, -1.0377490432811351528386012432747520506381988525390625000000000000, -0.7412493166610321093656921220826916396617889404296875000000000000},
{1.0903261845939333785082681060885079205036163330078125000000000000, 1.9625871322605028534979965115780942142009735107421875000000000000, 3.1074296249789452595280181412817910313606262207031250000000000000, 4.5569220297882528925015321874525398015975952148437500000000000000, 6.3431315960337464332496892893686890602111816406250000000000000000, 8.4981103969902296313421175000257790088653564453125000000000000000, 11.0537742038538713273965186090208590030670166015625000000000000000, 14.0411727461703197405995524604804813861846923828125000000000000000, 17.4872842084222561709339061053469777107238769531250000000000000000, 21.4044975021090095879117143340408802032470703125000000000000000000, 25.7646534406341984890786989126354455947875976562500000000000000000, 30.4517068934000540991746674990281462669372558593750000000000000000, 35.2027598648735136066534323617815971374511718750000000000000000000, 39.5745131312048030736150394659489393234252929687500000000000000000, 42.9876232281352557151876681018620729446411132812500000000000000000, 44.8731066637672668662162323016673326492309570312500000000000000000, 44.8731066637672739716435899026691913604736328125000000000000000000, 42.9876232281352699260423833038657903671264648437500000000000000000, 39.5745131312048243898971122689545154571533203125000000000000000000, 35.2027598648735349229355051647871732711791992187500000000000000000, 30.4517068934000754154567403020337224006652832031250000000000000000, 25.7646534406342198053607717156410217285156250000000000000000000000, 21.4044975021090309041937871370464563369750976562500000000000000000, 17.4872842084222206437971181003376841545104980468750000000000000000, 14.0411727461703126351721948594786226749420166015625000000000000000, 11.0537742038538659983260004082694649696350097656250000000000000000, 8.4981103969902243022715992992743849754333496093750000000000000000, 6.3431315960337562032123059907462447881698608398437500000000000000, 4.5569220297882608861073094885796308517456054687500000000000000000, 3.1074296249789514767769560421584174036979675292968750000000000000, 1.9625871322605077384793048622668720781803131103515625000000000000, 1.0903261845939369312219469065894372761249542236328125000000000000},
{1.6586888651098368185898834781255573034286499023437500000000000000, 3.8702740168043940904851751838577911257743835449218750000000000000, 7.3258756283563455369289840746205300092697143554687500000000000000, 12.3669811752662468506969162262976169586181640625000000000000000000, 19.3728841123627404385842964984476566314697265625000000000000000000, 28.7592191719511340863846271531656384468078613281250000000000000000, 40.9672499453982226214066031388938426971435546875000000000000000000, 56.4096032420115065519894415047019720077514648437500000000000000000, 75.2736194060236982750211609527468681335449218750000000000000000000, 97.0079558600526468126190593466162681579589843750000000000000000000, 119.3879487691786920322556397877633571624755859375000000000000000000, 137.4993690844631260006281081587076187133789062500000000000000000000, 143.7058195411480028269579634070396423339843750000000000000000000000, 129.8647588580246292622177861630916595458984375000000000000000000000, 91.7522578676396420860328362323343753814697265625000000000000000000, 33.2543901785339386378836934454739093780517578125000000000000000000, -33.2543901785336046827978861983865499496459960937500000000000000000, -91.7522578676393720797932473942637443542480468750000000000000000000, -129.8647588580244871536706341430544853210449218750000000000000000000, -143.7058195411479744052485330030322074890136718750000000000000000000, -137.4993690844631828440469689667224884033203125000000000000000000000, -119.3879487691787915082386462017893791198730468750000000000000000000, -97.0079558600527604994567809626460075378417968750000000000000000000, -75.2736194060234993230551481246948242187500000000000000000000000000, -56.4096032420114639194252958986908197402954101562500000000000000000, -40.9672499453981870942698151338845491409301757812500000000000000000, -28.7592191719511092173888755496591329574584960937500000000000000000, -19.3728841123627830711484421044588088989257812500000000000000000000, -12.3669811752662752724063466303050518035888671875000000000000000000, -7.3258756283563659650326371775008738040924072265625000000000000000, -3.8702740168044074131614706857362762093544006347656250000000000000, -1.6586888651098450342402657042839564383029937744140625000000000000},
{2.6643763057978517849733179900795221328735351562500000000000000000, 7.9931289167814414398094413627404719591140747070312500000000000000, 17.9845399844970117442244372796267271041870117187500000000000000000, 34.8327981724222581760841421782970428466796875000000000000000000000, 61.2805601853938668455157312564551830291748046875000000000000000000, 100.6756852006444802327678189612925052642822265625000000000000000000, 157.0202858388298352565470850095152854919433593750000000000000000000, 234.9760224242694448548718355596065521240234375000000000000000000000, 339.6909078802799513141508214175701141357421875000000000000000000000, 476.0965789013747553326538763940334320068359375000000000000000000000, 647.0780799517774539708625525236129760742187500000000000000000000000, 850.0511755803647702123271301388740539550781250000000000000000000000, 1072.5719816674063622485846281051635742187500000000000000000000000000, 1289.5394443131601747154491022229194641113281250000000000000000000000, 1465.6952847064619618322467431426048278808593750000000000000000000000, 1565.2171890039653590065427124500274658203125000000000000000000000000, 1565.2171890039655863802181556820869445800781250000000000000000000000, 1465.6952847064626439532730728387832641601562500000000000000000000000, 1289.5394443131610842101508751511573791503906250000000000000000000000, 1072.5719816674074991169618442654609680175781250000000000000000000000, 850.0511755803657933938666246831417083740234375000000000000000000000, 647.0780799517783634655643254518508911132812500000000000000000000000, 476.0965789013754942970990668982267379760742187500000000000000000000, 339.6909078802787576023547444492578506469726562500000000000000000000, 234.9760224242692174811963923275470733642578125000000000000000000000, 157.0202858388296931479999329894781112670898437500000000000000000000, 100.6756852006443523350753821432590484619140625000000000000000000000, 61.2805601853940231649175984784960746765136718750000000000000000000, 34.8327981724223647574945061933249235153198242187500000000000000000, 17.9845399844970756930706556886434555053710937500000000000000000000, 7.9931289167814769669462293677497655153274536132812500000000000000, 2.6643763057978695485417119925841689109802246093750000000000000000},
{4.5797408194033009110057719226460903882980346679687500000000000000, 17.4030150369142759814167220611125230789184570312500000000000000000, 46.2553739645286654535993875470012426376342773437500000000000000000, 102.4511562677456169012657483108341693878173828125000000000000000000, 202.0131706619037856853537959977984428405761718750000000000000000000, 366.7009114097518249764107167720794677734375000000000000000000000000, 624.7453333633784495759755373001098632812500000000000000000000000000, 1009.7873685431517287725000642240047454833984375000000000000000000000, 1553.6461386715427579474635422229766845703125000000000000000000000000, 2265.0091340779549682338256388902664184570312500000000000000000000000, 3088.5586379092019342351704835891723632812500000000000000000000000000, 3857.4476791292313464509788900613784790039062500000000000000000000000, 4283.2267490810636445530690252780914306640625000000000000000000000000, 4037.7429342959835594228934496641159057617187500000000000000000000000, 2929.2522074454550420341547578573226928710937500000000000000000000000, 1075.2235102360632481577340513467788696289062500000000000000000000000, -1075.2235102360521068476373329758644104003906250000000000000000000000, -2929.2522074454468565818388015031814575195312500000000000000000000000, -4037.7429342959799214440863579511642456054687500000000000000000000000, -4283.2267490810645540477707982063293457031250000000000000000000000000, -3857.4476791292340749350842088460922241210937500000000000000000000000, -3088.5586379092060269613284617662429809570312500000000000000000000000, -2265.0091340779586062126327306032180786132812500000000000000000000000, -1553.6461386715366188582265749573707580566406250000000000000000000000, -1009.7873685431505919041228480637073516845703125000000000000000000000, -624.7453333633777674549492076039314270019531250000000000000000000000, -366.7009114097513133856409694999456405639648437500000000000000000000, -202.0131706619044109629612648859620094299316406250000000000000000000, -102.4511562677459721726336283609271049499511718750000000000000000000, -46.2553739645288644055654003750532865524291992187500000000000000000, -17.4030150369143683519723708741366863250732421875000000000000000000, -4.5797408194033382144993993279058486223220825195312500000000000000},
{8.5207040555076254406685620779171586036682128906250000000000000000, 40.3313324893799034498442779295146465301513671875000000000000000000, 125.8223913306009649204497691243886947631835937500000000000000000000, 317.6215229876713692647172138094902038574218750000000000000000000000, 700.5125900659468243247829377651214599609375000000000000000000000000, 1403.5568261630878623691387474536895751953125000000000000000000000000, 2614.3471513248878181912004947662353515625000000000000000000000000000, 4593.2540802961193548981100320816040039062500000000000000000000000000, 7678.9192455956772391800768673419952392578125000000000000000000000000, 12261.5423455092150106793269515037536621093750000000000000000000000000, 18682.7944322609364462550729513168334960937500000000000000000000000000, 27026.7311318222346017137169837951660156250000000000000000000000000000, 36833.1154397322316071949899196624755859375000000000000000000000000000, 46888.8168284352359478361904621124267578125000000000000000000000000000, 55332.2334081224980764091014862060546875000000000000000000000000000000, 60194.6693208121796487830579280853271484375000000000000000000000000000, 60194.6693208121942006982862949371337890625000000000000000000000000000, 55332.2334081225344561971724033355712890625000000000000000000000000000, 46888.8168284352868795394897460937500000000000000000000000000000000000, 36833.1154397322752629406750202178955078125000000000000000000000000000, 27026.7311318222818954382091760635375976562500000000000000000000000000, 18682.7944322609728260431438684463500976562500000000000000000000000000, 12261.5423455092404765309765934944152832031250000000000000000000000000, 7678.9192455956399498973041772842407226562500000000000000000000000000, 4593.2540802961138979298993945121765136718750000000000000000000000000, 2614.3471513248837254650425165891647338867187500000000000000000000000, 1403.5568261630855886323843151330947875976562500000000000000000000000, 700.5125900659493254352128133177757263183593750000000000000000000000, 317.6215229876726766633510123938322067260742187500000000000000000000, 125.8223913306015901980572380125522613525390625000000000000000000000, 40.3313324893801592452291515655815601348876953125000000000000000000, 8.5207040555077053767263350891880691051483154296875000000000000000},
{17.3696084151919833971078332979232072830200195312500000000000000000, 100.7437250769851573295454727485775947570800781250000000000000000000, 366.4983320612182637887599412351846694946289062500000000000000000000, 1050.6403494089186096971388906240463256835937500000000000000000000000, 2585.5694157245989117654971778392791748046875000000000000000000000000, 5704.6114904086862225085496902465820312500000000000000000000000000000, 11564.3223146088330395286902785301208496093750000000000000000000000000, 21817.2051975810936710331588983535766601562500000000000000000000000000, 38421.3016963906120508909225463867187500000000000000000000000000000000, 62779.4854107597566326148808002471923828125000000000000000000000000000, 93871.2573484112654114142060279846191406250000000000000000000000000000, 125870.0465921123395673930644989013671875000000000000000000000000000000, 147232.9538936568133067339658737182617187500000000000000000000000000000, 143869.8363505482266191393136978149414062500000000000000000000000000000, 106732.9775948181195417419075965881347656250000000000000000000000000000, 39599.0636528912873473018407821655273437500000000000000000000000000000, -39599.0636528908653417602181434631347656250000000000000000000000000000, -106732.9775948178139515221118927001953125000000000000000000000000000000, -143869.8363505480810999870300292968750000000000000000000000000000000000, -147232.9538936568424105644226074218750000000000000000000000000000000000, -125870.0465921124705346301198005676269531250000000000000000000000000000, -93871.2573484114254824817180633544921875000000000000000000000000000000, -62779.4854107598948758095502853393554687500000000000000000000000000000, -38421.3016963904083240777254104614257812500000000000000000000000000000, -21817.2051975810645672027021646499633789062500000000000000000000000000, -11564.3223146088148496346548199653625488281250000000000000000000000000, -5704.6114904086762180668301880359649658203125000000000000000000000000, -2585.5694157246098257019184529781341552734375000000000000000000000000, -1050.6403494089236119179986417293548583984375000000000000000000000000, -366.4983320612203101518389303237199783325195312500000000000000000000, -100.7437250769858820831359480507671833038330078125000000000000000000, -17.3696084151921716909328097244724631309509277343750000000000000000},
{39.3841324625754651833631214685738086700439453125000000000000000000, 275.6889243994923504033067729324102401733398437500000000000000000000, 1161.8315357693475107225822284817695617675781250000000000000000000000, 3768.1168779445524705806747078895568847656250000000000000000000000000, 10323.9889340111440105829387903213500976562500000000000000000000000000, 25067.6519656961063446942716836929321289062500000000000000000000000000, 55486.3343873788471682928502559661865234375000000000000000000000000000, 113913.1307824491959763690829277038574218750000000000000000000000000000, 218987.8708525153633672744035720825195312500000000000000000000000000000, 395410.1975829104776494204998016357421875000000000000000000000000000000, 669003.8892456996254622936248779296875000000000000000000000000000000000, 1054154.9241341308224946260452270507812500000000000000000000000000000000, 1534925.7468206542544066905975341796875000000000000000000000000000000000, 2049583.8385174190625548362731933593750000000000000000000000000000000000, 2494202.7338306303136050701141357421875000000000000000000000000000000000, 2754419.6236776066944003105163574218750000000000000000000000000000000000, 2754419.6236776071600615978240966796875000000000000000000000000000000000, 2494202.7338306321762502193450927734375000000000000000000000000000000000, 2049583.8385174213908612728118896484375000000000000000000000000000000000, 1534925.7468206568155437707901000976562500000000000000000000000000000000, 1054154.9241341329179704189300537109375000000000000000000000000000000000, 669003.8892457012552767992019653320312500000000000000000000000000000000, 395410.1975829115835949778556823730468750000000000000000000000000000000, 218987.8708525140245910733938217163085937500000000000000000000000000000, 113913.1307824490068014711141586303710937500000000000000000000000000000, 55486.3343873787453048862516880035400390625000000000000000000000000000, 25067.6519656960554129909723997116088867187500000000000000000000000000, 10323.9889340111913043074309825897216796875000000000000000000000000000, 3768.1168779445724794641137123107910156250000000000000000000000000000, 1161.8315357693547866801964119076728820800781250000000000000000000000, 275.6889243994945104532234836369752883911132812500000000000000000000, 39.3841324625759270361413655336946249008178710937500000000000000000},
{101.4214356966497518897085683420300483703613281250000000000000000000, 845.1784034174261250882409512996673583984375000000000000000000000000, 4099.0915024127289143507368862628936767578125000000000000000000000000, 14981.0130092849976790603250265121459960937500000000000000000000000000, 45557.9971324445141362957656383514404296875000000000000000000000000000, 121252.9899121620983351022005081176757812500000000000000000000000000000, 290407.2482352344086393713951110839843750000000000000000000000000000000, 634277.3096194358076900243759155273437500000000000000000000000000000000, 1265740.5657731452956795692443847656250000000000000000000000000000000000, 2291752.6816867603920400142669677734375000000000000000000000000000000000, 3714937.5888180439360439777374267578125000000000000000000000000000000000, 5294221.1640127329155802726745605468750000000000000000000000000000000000, 6471749.9919786201789975166320800781250000000000000000000000000000000000, 6517699.7646292932331562042236328125000000000000000000000000000000000000, 4926762.2470986694097518920898437500000000000000000000000000000000000000, 1844325.2996146974619477987289428710937500000000000000000000000000000000, -1844325.2996146772056818008422851562500000000000000000000000000000000000, -4926762.2470986554399132728576660156250000000000000000000000000000000000, -6517699.7646292885765433311462402343750000000000000000000000000000000000, -6471749.9919786229729652404785156250000000000000000000000000000000000000, -5294221.1640127394348382949829101562500000000000000000000000000000000000, -3714937.5888180513866245746612548828125000000000000000000000000000000000, -2291752.6816867664456367492675781250000000000000000000000000000000000000, -1265740.5657731371466070413589477539062500000000000000000000000000000000, -634277.3096194346435368061065673828125000000000000000000000000000000000, -290407.2482352338265627622604370117187500000000000000000000000000000000, -121252.9899121618218487128615379333496093750000000000000000000000000000, -45557.9971324447469669394195079803466796875000000000000000000000000000, -14981.0130092850849905516952276229858398437500000000000000000000000000, -4099.0915024127571086864918470382690429687500000000000000000000000000, -845.1784034174335147326928563416004180908203125000000000000000000000, -101.4214356966510450774876517243683338165283203125000000000000000000},
{306.4032748367150134072289802134037017822265625000000000000000000000, 3002.7518304647710465360432863235473632812500000000000000000000000000, 16652.9833618406264577060937881469726562500000000000000000000000000000, 68318.1475105366989737376570701599121093750000000000000000000000000000, 230128.4325094087398611009120941162109375000000000000000000000000000000, 672011.2699823827715590596199035644531250000000000000000000000000000000, 1756159.7036680860910564661026000976562500000000000000000000000000000000, 4184322.1088861329481005668640136718750000000000000000000000000000000000, 9173625.5252349879592657089233398437500000000000000000000000000000000000, 18540251.2681118324398994445800781250000000000000000000000000000000000000, 34429790.3628919124603271484375000000000000000000000000000000000000000000, 58400540.7136798426508903503417968750000000000000000000000000000000000000, 89894234.6657222658395767211914062500000000000000000000000000000000000000, 124850148.8339526355266571044921875000000000000000000000000000000000000000, 155777817.0474672913551330566406250000000000000000000000000000000000000000, 174124632.9045651257038116455078125000000000000000000000000000000000000000, 174124632.9045651555061340332031250000000000000000000000000000000000000000, 155777817.0474674105644226074218750000000000000000000000000000000000000000, 124850148.8339528143405914306640625000000000000000000000000000000000000000, 89894234.6657224297523498535156250000000000000000000000000000000000000000, 58400540.7136799767613410949707031250000000000000000000000000000000000000, 34429790.3628920093178749084472656250000000000000000000000000000000000000, 18540251.2681118920445442199707031250000000000000000000000000000000000000, 9173625.5252349209040403366088867187500000000000000000000000000000000000, 4184322.1088861245661973953247070312500000000000000000000000000000000000, 1756159.7036680821329355239868164062500000000000000000000000000000000000, 672011.2699823811417445540428161621093750000000000000000000000000000000, 230128.4325094100495334714651107788085937500000000000000000000000000000, 68318.1475105371355311945080757141113281250000000000000000000000000000, 16652.9833618407537869643419981002807617187500000000000000000000000000, 3002.7518304647992408717982470989227294921875000000000000000000000000, 306.4032748367192198202246800065040588378906250000000000000000000000},
{1151.7842948347220044524874538183212280273437500000000000000000000000, 13130.3189528035763942170888185501098632812500000000000000000000000000, 82753.2781820556119782850146293640136718750000000000000000000000000000, 379477.3476921792607754468917846679687500000000000000000000000000000000, 1410081.7932857484556734561920166015625000000000000000000000000000000000, 4484906.5092664165422320365905761718750000000000000000000000000000000000, 12569161.5413249637931585311889648437500000000000000000000000000000000000, 31429171.3228509016335010528564453125000000000000000000000000000000000000, 70180841.7627102434635162353515625000000000000000000000000000000000000000, 139001962.7039601802825927734375000000000000000000000000000000000000000000, 241419277.1539796292781829833984375000000000000000000000000000000000000000, 362148919.0094355344772338867187500000000000000000000000000000000000000000, 459278903.7562895417213439941406250000000000000000000000000000000000000000, 474300505.9106718897819519042968750000000000000000000000000000000000000000, 364157479.4660055041313171386718750000000000000000000000000000000000000000, 137341576.4290517270565032958984375000000000000000000000000000000000000000, -137341576.4290501773357391357421875000000000000000000000000000000000000000, -364157479.4660044312477111816406250000000000000000000000000000000000000000, -474300505.9106715321540832519531250000000000000000000000000000000000000000, -459278903.7562897801399230957031250000000000000000000000000000000000000000, -362148919.0094360709190368652343750000000000000000000000000000000000000000, -241419277.1539801955223083496093750000000000000000000000000000000000000000, -139001962.7039605975151062011718750000000000000000000000000000000000000000, -70180841.7627097368240356445312500000000000000000000000000000000000000000, -31429171.3228508345782756805419921875000000000000000000000000000000000000, -12569161.5413249339908361434936523437500000000000000000000000000000000000, -4484906.5092664044350385665893554687500000000000000000000000000000000000, -1410081.7932857570704072713851928710937500000000000000000000000000000000, -379477.3476921818801201879978179931640625000000000000000000000000000000, -82753.2781820562959183007478713989257812500000000000000000000000000000, -13130.3189528037091804435476660728454589843750000000000000000000000000, -1151.7842948347386027307948097586631774902343750000000000000000000000},
{6219.6353187053327928879298269748687744140625000000000000000000000000, 81684.4934947053261566907167434692382812500000000000000000000000000000, 581632.8888095013098791241645812988281250000000000000000000000000000000, 2970668.3215714376419782638549804687500000000000000000000000000000000000, 12165358.0109994895756244659423828125000000000000000000000000000000000000, 42344933.0679178237915039062500000000000000000000000000000000000000000000, 129551133.6225747913122177124023437500000000000000000000000000000000000000, 354876651.4123159050941467285156250000000000000000000000000000000000000000, 877428853.6127600669860839843750000000000000000000000000000000000000000000, 1960082272.8952224254608154296875000000000000000000000000000000000000000000, 3944226030.8837418556213378906250000000000000000000000000000000000000000000, 7117679183.4813089370727539062500000000000000000000000000000000000000000000, 11469328619.4277858734130859375000000000000000000000000000000000000000000000, 16446893770.0797958374023437500000000000000000000000000000000000000000000000, 20938929516.9664001464843750000000000000000000000000000000000000000000000000, 23633746371.3169097900390625000000000000000000000000000000000000000000000000, 23633746371.3169136047363281250000000000000000000000000000000000000000000000, 20938929516.9664192199707031250000000000000000000000000000000000000000000000, 16446893770.0798206329345703125000000000000000000000000000000000000000000000, 11469328619.4278087615966796875000000000000000000000000000000000000000000000, 7117679183.4813270568847656250000000000000000000000000000000000000000000000, 3944226030.8837542533874511718750000000000000000000000000000000000000000000, 1960082272.8952298164367675781250000000000000000000000000000000000000000000, 877428853.6127526760101318359375000000000000000000000000000000000000000000, 354876651.4123150706291198730468750000000000000000000000000000000000000000, 129551133.6225744634866714477539062500000000000000000000000000000000000000, 42344933.0679177045822143554687500000000000000000000000000000000000000000, 12165358.0109995678067207336425781250000000000000000000000000000000000000, 2970668.3215714595280587673187255859375000000000000000000000000000000000, 581632.8888095063157379627227783203125000000000000000000000000000000000, 81684.4934947062138235196471214294433593750000000000000000000000000000, 6219.6353187054273803369142115116119384765625000000000000000000000000},
};

const static flag_spectral_float  Flag_Spectral_Pl[FLAG_SPECTRAL_ORDER][FLAG_SPECTRAL_NDELTA] = {
{0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000},
{-0.4309458036856673168735198942158604040741920471191406250000000000, -0.3646464492724877382023862537607783451676368713378906250000000000, -0.2983470948593081595312526133056962862610816955566406250000000000, -0.2320477404461285531045433572217007167637348175048828125000000000, -0.1657483860329489744334097167666186578571796417236328125000000000, -0.0994490316197693818844882684970798436552286148071289062500000000, -0.0331496772065897962744607241347694071009755134582519531250000000, 0.0331496772065897962744607241347694071009755134582519531250000000, 0.0994490316197693818844882684970798436552286148071289062500000000, 0.1657483860329489744334097167666186578571796417236328125000000000, 0.2320477404461285531045433572217007167637348175048828125000000000, 0.2983470948593081595312526133056962862610816955566406250000000000, 0.3646464492724877382023862537607783451676368713378906250000000000, 0.4309458036856673168735198942158604040741920471191406250000000000},
{0.4818120558297157574045854744326788932085037231445312500000000000, 0.2594372608313854078332383323868270963430404663085937500000000000, 0.0741249316661101165237823806819505989551544189453125000000000000, -0.0741249316661101165237823806819505989551544189453125000000000000, -0.1853123291652752913094559517048764973878860473632812500000000000, -0.2594372608313854078332383323868270963430404663085937500000000000, -0.2964997266644404660951295227278023958206176757812500000000000000, -0.2964997266644404660951295227278023958206176757812500000000000000, -0.2594372608313854078332383323868270963430404663085937500000000000, -0.1853123291652752913094559517048764973878860473632812500000000000, -0.0741249316661101165237823806819505989551544189453125000000000000, 0.0741249316661101165237823806819505989551544189453125000000000000, 0.2594372608313854078332383323868270963430404663085937500000000000, 0.4818120558297157574045854744326788932085037231445312500000000000},
{-0.4585783658733355583336788185988552868366241455078125000000000000, -0.0352752589133335028859228543751669349148869514465332031250000000, 0.2116515534800010311933249340654583647847175598144531250000000000, 0.3142704885006075699038774473592638969421386718750000000000000000, 0.3046499633424257225122744330292334780097007751464843750000000000, 0.2148583951993949803238592721754685044288635253906250000000000000, 0.0769642012654549179107021927848109044134616851806640625000000000, -0.0769642012654549179107021927848109044134616851806640625000000000, -0.2148583951993949803238592721754685044288635253906250000000000000, -0.3046499633424257225122744330292334780097007751464843750000000000, -0.3142704885006075699038774473592638969421386718750000000000000000, -0.2116515534800010311933249340654583647847175598144531250000000000, 0.0352752589133335028859228543751669349148869514465332031250000000, 0.4585783658733355583336788185988552868366241455078125000000000000},
{0.3875694570442999031811837085115257650613784790039062500000000000, -0.2086912461007768837539799733349354937672615051269531250000000000, -0.3577564218870460943655587016110075637698173522949218750000000000, -0.2493453849515775699874353676932514645159244537353515625000000000, -0.0352335870040272683412219123511022189632058143615722656250000000, 0.1707473831733629099360882719338405877351760864257812500000000000, 0.2927097997257649963920300706377020105719566345214843750000000000, 0.2927097997257649963920300706377020105719566345214843750000000000, 0.1707473831733629099360882719338405877351760864257812500000000000, -0.0352335870040272683412219123511022189632058143615722656250000000, -0.2493453849515775699874353676932514645159244537353515625000000000, -0.3577564218870460943655587016110075637698173522949218750000000000, -0.2086912461007768837539799733349354937672615051269531250000000000, 0.3875694570442999031811837085115257650613784790039062500000000000},
{-0.2948961391092899120280890201684087514877319335937500000000000000, 0.3856334126813791285393051566643407568335533142089843750000000000, 0.2722118207162676495336484094877960160374641418457031250000000000, -0.0577419013640567690970328840194270014762878417968750000000000000, -0.2866472960572818418079066304926527664065361022949218750000000000, -0.2990205606352939748937558306352002546191215515136718750000000000, -0.1237326457801216500476115811579802539199590682983398437500000000, 0.1237326457801216500476115811579802539199590682983398437500000000, 0.2990205606352939748937558306352002546191215515136718750000000000, 0.2866472960572818418079066304926527664065361022949218750000000000, 0.0577419013640567690970328840194270014762878417968750000000000000, -0.2722118207162676495336484094877960160374641418457031250000000000, -0.3856334126813791285393051566643407568335533142089843750000000000, 0.2948961391092899120280890201684087514877319335937500000000000000},
{0.2027563273040598468277551091887289658188819885253906250000000000, -0.4523025762936719873508195632894057780504226684570312500000000000, -0.0155966405618507587826915283812923007644712924957275390625000000, 0.3218579461400111196844875394162954762578010559082031250000000000, 0.2623071367220354832561213243025122210383415222167968750000000000, -0.0354469103678426294967707121941202785819768905639648437500000000, -0.2835752829427410359741656975529622286558151245117187500000000000, -0.2835752829427410359741656975529622286558151245117187500000000000, -0.0354469103678426294967707121941202785819768905639648437500000000, 0.2623071367220354832561213243025122210383415222167968750000000000, 0.3218579461400111196844875394162954762578010559082031250000000000, -0.0155966405618507587826915283812923007644712924957275390625000000, -0.4523025762936719873508195632894057780504226684570312500000000000, 0.2027563273040598468277551091887289658188819885253906250000000000},
{-0.1257441362172087295778766247167368419468402862548828125000000000, 0.4159229121030749709575502492953091859817504882812500000000000000, -0.2611608982972796755284150549414334818720817565917968750000000000, -0.3104033572354872316800822318327846005558967590332031250000000000, 0.0835363142701736199891016099172702524811029434204101562500000000, 0.3297486089612116644254058428487041965126991271972656250000000000, 0.1758659247793128987957800291042076423764228820800781250000000000, -0.1758659247793128987957800291042076423764228820800781250000000000, -0.3297486089612116644254058428487041965126991271972656250000000000, -0.0835363142701736199891016099172702524811029434204101562500000000, 0.3104033572354872316800822318327846005558967590332031250000000000, 0.2611608982972796755284150549414334818720817565917968750000000000, -0.4159229121030749709575502492953091859817504882812500000000000000, 0.1257441362172087295778766247167368419468402862548828125000000000},
{0.0699086407042275592704783093722653575241565704345703125000000000, -0.3172776770422635062018912321946118026971817016601562500000000000, 0.4248294319718443623479231519013410434126853942871093750000000000, 0.0376431142253532968755536103344638831913471221923828125000000000, -0.3495432035211377685968159312324132770299911499023437500000000000, -0.1344396936619760840603277074478683061897754669189453125000000000, 0.2688793873239521681206554148957366123795509338378906250000000000, 0.2688793873239521681206554148957366123795509338378906250000000000, -0.1344396936619760840603277074478683061897754669189453125000000000, -0.3495432035211377685968159312324132770299911499023437500000000000, 0.0376431142253532968755536103344638831913471221923828125000000000, 0.4248294319718443623479231519013410434126853942871093750000000000, -0.3172776770422635062018912321946118026971817016601562500000000000, 0.0699086407042275592704783093722653575241565704345703125000000000},
{-0.0344591278812576007339885109104216098785400390625000000000000000, 0.2041040651428334962158572807311429642140865325927734375000000000, -0.4320644495880761049022567021893337368965148925781250000000000000, 0.2836251294841972137028562883642734959721565246582031250000000000, 0.2359124908793789887617720069101778790354728698730468750000000000, -0.2783237251947729418155574876436730846762657165527343750000000000, -0.2385631930240910969498457916415645740926265716552734375000000000, 0.2385631930240910969498457916415645740926265716552734375000000000, 0.2783237251947729418155574876436730846762657165527343750000000000, -0.2359124908793789887617720069101778790354728698730468750000000000, -0.2836251294841972137028562883642734959721565246582031250000000000, 0.4320644495880761049022567021893337368965148925781250000000000000, -0.2041040651428334962158572807311429642140865325927734375000000000, 0.0344591278812576007339885109104216098785400390625000000000000000},
{0.0147897728358395794817647939112248423043638467788696289062500000, -0.1103544588520337932369130840015714056789875030517578125000000000, 0.3276503520555230086763742747280048206448554992675781250000000000, -0.4459685347422396306527048182033468037843704223632812500000000000, 0.1422093541907651914613097687833942472934722900390625000000000000, 0.3174112785537879233288549585267901420593261718750000000000000000, -0.2457377640416422426294928982315468601882457733154296875000000000, -0.2457377640416422426294928982315468601882457733154296875000000000, 0.3174112785537879233288549585267901420593261718750000000000000000, 0.1422093541907651914613097687833942472934722900390625000000000000, -0.4459685347422396306527048182033468037843704223632812500000000000, 0.3276503520555230086763742747280048206448554992675781250000000000, -0.1103544588520337932369130840015714056789875030517578125000000000, 0.0147897728358395794817647939112248423043638467788696289062500000},
{-0.0053617479838052716639706929413478064816445112228393554687500000, 0.0490806161594482537324779514165129512548446655273437500000000000, -0.1913731588065881450422267562316847033798694610595703125000000000, 0.3992440037171925415471207543305354192852973937988281250000000000, -0.4310020494674237645504888405412202700972557067871093750000000000, 0.0952741372506936690101042586320545524358749389648437500000000000, 0.3266541848595211350314571063790936022996902465820312500000000000, -0.3266541848595211350314571063790936022996902465820312500000000000, -0.0952741372506936690101042586320545524358749389648437500000000000, 0.4310020494674237645504888405412202700972557067871093750000000000, -0.3992440037171925415471207543305354192852973937988281250000000000, 0.1913731588065881450422267562316847033798694610595703125000000000, -0.0490806161594482537324779514165129512548446655273437500000000000, 0.0053617479838052716639706929413478064816445112228393554687500000},
{0.0015503894602372355823738381275234132772311568260192871093750000, -0.0170542840626095905387504814143539988435804843902587890625000000, 0.0837210308528107266523576868166856002062559127807617187500000000, -0.2387599768765342744814006437081843614578247070312500000000000000, 0.4263571015652398155104663146630628034472465515136718750000000000, -0.4604656696904589896490733735845424234867095947265625000000000000, 0.2046514087513151003427935847867047414183616638183593750000000000, 0.2046514087513151003427935847867047414183616638183593750000000000, -0.4604656696904589896490733735845424234867095947265625000000000000, 0.4263571015652398155104663146630628034472465515136718750000000000, -0.2387599768765342744814006437081843614578247070312500000000000000, 0.0837210308528107266523576868166856002062559127807617187500000000, -0.0170542840626095905387504814143539988435804843902587890625000000, 0.0015503894602372355823738381275234132772311568260192871093750000},
{-0.0003100778920474471056327459006496383153717033565044403076171875, 0.0040310125966168128611166743269222934031859040260314941406250000, -0.0241860755797008754319765699847266660071909427642822265625000000, 0.0886822771255698777403964072618691716343164443969726562500000000, -0.2217056928139246874120971142474445514380931854248046875000000000, 0.3990702470650644428928899287711828947067260742187500000000000000, -0.5320936627534192941979540592001285403966903686523437500000000000, 0.5320936627534192941979540592001285403966903686523437500000000000, -0.3990702470650644428928899287711828947067260742187500000000000000, 0.2217056928139246874120971142474445514380931854248046875000000000, -0.0886822771255698777403964072618691716343164443969726562500000000, 0.0241860755797008754319765699847266660071909427642822265625000000, -0.0040310125966168128611166743269222934031859040260314941406250000, 0.0003100778920474471056327459006496383153717033565044403076171875},
};

const static flag_spectral_float  Flag_Spectral_Pr[FLAG_SPECTRAL_ORDER][FLAG_SPECTRAL_NDELTA] = {
{0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000, 0.2672612419124243965384835064469370990991592407226562500000000000},
{-0.4309458036856673168735198942158604040741920471191406250000000000, -0.3646464492724877382023862537607783451676368713378906250000000000, -0.2983470948593081595312526133056962862610816955566406250000000000, -0.2320477404461285531045433572217007167637348175048828125000000000, -0.1657483860329489744334097167666186578571796417236328125000000000, -0.0994490316197693818844882684970798436552286148071289062500000000, -0.0331496772065897962744607241347694071009755134582519531250000000, 0.0331496772065897962744607241347694071009755134582519531250000000, 0.0994490316197693818844882684970798436552286148071289062500000000, 0.1657483860329489744334097167666186578571796417236328125000000000, 0.2320477404461285531045433572217007167637348175048828125000000000, 0.2983470948593081595312526133056962862610816955566406250000000000, 0.3646464492724877382023862537607783451676368713378906250000000000, 0.4309458036856673168735198942158604040741920471191406250000000000},
{0.4818120558297157574045854744326788932085037231445312500000000000, 0.2594372608313854078332383323868270963430404663085937500000000000, 0.0741249316661101165237823806819505989551544189453125000000000000, -0.0741249316661101165237823806819505989551544189453125000000000000, -0.1853123291652752913094559517048764973878860473632812500000000000, -0.2594372608313854078332383323868270963430404663085937500000000000, -0.2964997266644404660951295227278023958206176757812500000000000000, -0.2964997266644404660951295227278023958206176757812500000000000000, -0.2594372608313854078332383323868270963430404663085937500000000000, -0.1853123291652752913094559517048764973878860473632812500000000000, -0.0741249316661101165237823806819505989551544189453125000000000000, 0.0741249316661101165237823806819505989551544189453125000000000000, 0.2594372608313854078332383323868270963430404663085937500000000000, 0.4818120558297157574045854744326788932085037231445312500000000000},
{-0.4585783658733355583336788185988552868366241455078125000000000000, -0.0352752589133335028859228543751669349148869514465332031250000000, 0.2116515534800010311933249340654583647847175598144531250000000000, 0.3142704885006075699038774473592638969421386718750000000000000000, 0.3046499633424257225122744330292334780097007751464843750000000000, 0.2148583951993949803238592721754685044288635253906250000000000000, 0.0769642012654549179107021927848109044134616851806640625000000000, -0.0769642012654549179107021927848109044134616851806640625000000000, -0.2148583951993949803238592721754685044288635253906250000000000000, -0.3046499633424257225122744330292334780097007751464843750000000000, -0.3142704885006075699038774473592638969421386718750000000000000000, -0.2116515534800010311933249340654583647847175598144531250000000000, 0.0352752589133335028859228543751669349148869514465332031250000000, 0.4585783658733355583336788185988552868366241455078125000000000000},
{0.3875694570442999031811837085115257650613784790039062500000000000, -0.2086912461007768837539799733349354937672615051269531250000000000, -0.3577564218870460943655587016110075637698173522949218750000000000, -0.2493453849515775699874353676932514645159244537353515625000000000, -0.0352335870040272683412219123511022189632058143615722656250000000, 0.1707473831733629099360882719338405877351760864257812500000000000, 0.2927097997257649963920300706377020105719566345214843750000000000, 0.2927097997257649963920300706377020105719566345214843750000000000, 0.1707473831733629099360882719338405877351760864257812500000000000, -0.0352335870040272683412219123511022189632058143615722656250000000, -0.2493453849515775699874353676932514645159244537353515625000000000, -0.3577564218870460943655587016110075637698173522949218750000000000, -0.2086912461007768837539799733349354937672615051269531250000000000, 0.3875694570442999031811837085115257650613784790039062500000000000},
{-0.2948961391092899120280890201684087514877319335937500000000000000, 0.3856334126813791285393051566643407568335533142089843750000000000, 0.2722118207162676495336484094877960160374641418457031250000000000, -0.0577419013640567690970328840194270014762878417968750000000000000, -0.2866472960572818418079066304926527664065361022949218750000000000, -0.2990205606352939748937558306352002546191215515136718750000000000, -0.1237326457801216500476115811579802539199590682983398437500000000, 0.1237326457801216500476115811579802539199590682983398437500000000, 0.2990205606352939748937558306352002546191215515136718750000000000, 0.2866472960572818418079066304926527664065361022949218750000000000, 0.0577419013640567690970328840194270014762878417968750000000000000, -0.2722118207162676495336484094877960160374641418457031250000000000, -0.3856334126813791285393051566643407568335533142089843750000000000, 0.2948961391092899120280890201684087514877319335937500000000000000},
{0.2027563273040598468277551091887289658188819885253906250000000000, -0.4523025762936719873508195632894057780504226684570312500000000000, -0.0155966405618507587826915283812923007644712924957275390625000000, 0.3218579461400111196844875394162954762578010559082031250000000000, 0.2623071367220354832561213243025122210383415222167968750000000000, -0.0354469103678426294967707121941202785819768905639648437500000000, -0.2835752829427410359741656975529622286558151245117187500000000000, -0.2835752829427410359741656975529622286558151245117187500000000000, -0.0354469103678426294967707121941202785819768905639648437500000000, 0.2623071367220354832561213243025122210383415222167968750000000000, 0.3218579461400111196844875394162954762578010559082031250000000000, -0.0155966405618507587826915283812923007644712924957275390625000000, -0.4523025762936719873508195632894057780504226684570312500000000000, 0.2027563273040598468277551091887289658188819885253906250000000000},
{-0.1257441362172087295778766247167368419468402862548828125000000000, 0.4159229121030749709575502492953091859817504882812500000000000000, -0.2611608982972796755284150549414334818720817565917968750000000000, -0.3104033572354872316800822318327846005558967590332031250000000000, 0.0835363142701736199891016099172702524811029434204101562500000000, 0.3297486089612116644254058428487041965126991271972656250000000000, 0.1758659247793128987957800291042076423764228820800781250000000000, -0.1758659247793128987957800291042076423764228820800781250000000000, -0.3297486089612116644254058428487041965126991271972656250000000000, -0.0835363142701736199891016099172702524811029434204101562500000000, 0.3104033572354872316800822318327846005558967590332031250000000000, 0.2611608982972796755284150549414334818720817565917968750000000000, -0.4159229121030749709575502492953091859817504882812500000000000000, 0.1257441362172087295778766247167368419468402862548828125000000000},
{0.0699086407042275592704783093722653575241565704345703125000000000, -0.3172776770422635062018912321946118026971817016601562500000000000, 0.4248294319718443623479231519013410434126853942871093750000000000, 0.0376431142253532968755536103344638831913471221923828125000000000, -0.3495432035211377685968159312324132770299911499023437500000000000, -0.1344396936619760840603277074478683061897754669189453125000000000, 0.2688793873239521681206554148957366123795509338378906250000000000, 0.2688793873239521681206554148957366123795509338378906250000000000, -0.1344396936619760840603277074478683061897754669189453125000000000, -0.3495432035211377685968159312324132770299911499023437500000000000, 0.0376431142253532968755536103344638831913471221923828125000000000, 0.4248294319718443623479231519013410434126853942871093750000000000, -0.3172776770422635062018912321946118026971817016601562500000000000, 0.0699086407042275592704783093722653575241565704345703125000000000},
{-0.0344591278812576007339885109104216098785400390625000000000000000, 0.2041040651428334962158572807311429642140865325927734375000000000, -0.4320644495880761049022567021893337368965148925781250000000000000, 0.2836251294841972137028562883642734959721565246582031250000000000, 0.2359124908793789887617720069101778790354728698730468750000000000, -0.2783237251947729418155574876436730846762657165527343750000000000, -0.2385631930240910969498457916415645740926265716552734375000000000, 0.2385631930240910969498457916415645740926265716552734375000000000, 0.2783237251947729418155574876436730846762657165527343750000000000, -0.2359124908793789887617720069101778790354728698730468750000000000, -0.2836251294841972137028562883642734959721565246582031250000000000, 0.4320644495880761049022567021893337368965148925781250000000000000, -0.2041040651428334962158572807311429642140865325927734375000000000, 0.0344591278812576007339885109104216098785400390625000000000000000},
{0.0147897728358395794817647939112248423043638467788696289062500000, -0.1103544588520337932369130840015714056789875030517578125000000000, 0.3276503520555230086763742747280048206448554992675781250000000000, -0.4459685347422396306527048182033468037843704223632812500000000000, 0.1422093541907651914613097687833942472934722900390625000000000000, 0.3174112785537879233288549585267901420593261718750000000000000000, -0.2457377640416422426294928982315468601882457733154296875000000000, -0.2457377640416422426294928982315468601882457733154296875000000000, 0.3174112785537879233288549585267901420593261718750000000000000000, 0.1422093541907651914613097687833942472934722900390625000000000000, -0.4459685347422396306527048182033468037843704223632812500000000000, 0.3276503520555230086763742747280048206448554992675781250000000000, -0.1103544588520337932369130840015714056789875030517578125000000000, 0.0147897728358395794817647939112248423043638467788696289062500000},
{-0.0053617479838052716639706929413478064816445112228393554687500000, 0.0490806161594482537324779514165129512548446655273437500000000000, -0.1913731588065881450422267562316847033798694610595703125000000000, 0.3992440037171925415471207543305354192852973937988281250000000000, -0.4310020494674237645504888405412202700972557067871093750000000000, 0.0952741372506936690101042586320545524358749389648437500000000000, 0.3266541848595211350314571063790936022996902465820312500000000000, -0.3266541848595211350314571063790936022996902465820312500000000000, -0.0952741372506936690101042586320545524358749389648437500000000000, 0.4310020494674237645504888405412202700972557067871093750000000000, -0.3992440037171925415471207543305354192852973937988281250000000000, 0.1913731588065881450422267562316847033798694610595703125000000000, -0.0490806161594482537324779514165129512548446655273437500000000000, 0.0053617479838052716639706929413478064816445112228393554687500000},
{0.0015503894602372355823738381275234132772311568260192871093750000, -0.0170542840626095905387504814143539988435804843902587890625000000, 0.0837210308528107266523576868166856002062559127807617187500000000, -0.2387599768765342744814006437081843614578247070312500000000000000, 0.4263571015652398155104663146630628034472465515136718750000000000, -0.4604656696904589896490733735845424234867095947265625000000000000, 0.2046514087513151003427935847867047414183616638183593750000000000, 0.2046514087513151003427935847867047414183616638183593750000000000, -0.4604656696904589896490733735845424234867095947265625000000000000, 0.4263571015652398155104663146630628034472465515136718750000000000, -0.2387599768765342744814006437081843614578247070312500000000000000, 0.0837210308528107266523576868166856002062559127807617187500000000, -0.0170542840626095905387504814143539988435804843902587890625000000, 0.0015503894602372355823738381275234132772311568260192871093750000},
{-0.0003100778920474471056327459006496383153717033565044403076171875, 0.0040310125966168128611166743269222934031859040260314941406250000, -0.0241860755797008754319765699847266660071909427642822265625000000, 0.0886822771255698777403964072618691716343164443969726562500000000, -0.2217056928139246874120971142474445514380931854248046875000000000, 0.3990702470650644428928899287711828947067260742187500000000000000, -0.5320936627534192941979540592001285403966903686523437500000000000, 0.5320936627534192941979540592001285403966903686523437500000000000, -0.3990702470650644428928899287711828947067260742187500000000000000, 0.2217056928139246874120971142474445514380931854248046875000000000, -0.0886822771255698777403964072618691716343164443969726562500000000, 0.0241860755797008754319765699847266660071909427642822265625000000, -0.0040310125966168128611166743269222934031859040260314941406250000, 0.0003100778920474471056327459006496383153717033565044403076171875},
};


//-------------------------------------------------------------------------------------------------------
// Function    :  Flag_Spectral_Prepare_for_Spectral_Criterion
// Description :  Evaluate ratio of average density of wave function in patch group and average density of wave function in extension domain
//                The logic behind this comparison is as follows:
//                The Gram-Fourier extension is computed by expanding the wave function at the patch boundaries in terms of orthogonal polynomials.
//                The extension is then computed via the weighted sum of periodic extensions of these polynomials.
//                The coefficients of the boundary polynomials can be shown to decay exponentially for a well-resolved function.
//                If the function is not well-resolved the polynomials decay more slowly.
//                As a result, the higher-order polynomials will have a higher weight.
//                The higher-order polynomials also have much more massive extensions  ( empirically density roughly 10^(polynomial order) ).
//                Therefore, a less well-resolved function will have a extension with a higher average density.
//                As a consequence, the average extension density can be used to estimate the resolution of the wave function in the physical domain.
//
// Note        :  1. This function is called once per patch group
//                2. The size of the array Var1D must be FLU_NXT^3
//                3. Assume a ghost size of FLU_GHOST_SIZE in order to match the GramFE extension algorithm
//                   This is required in order to compute the same extensions that are also computed in the GramFE wave solver
//
// Parameter   :  Var1D     : Array storing the input re & im
//                Cond      : Reference to floating point variable where density ratio is stored
//
// Return      :  None
//-------------------------------------------------------------------------------------------------------
void Prepare_for_Spectral_Criterion(const real *Var1D, real& Cond)
{
// set the stride to a small value to sample the wave function evenly
// 1, 2, 4 should all work, but higher values are faster
   const size_t Stride = 4;

   const real* Re1D = Var1D;
   const real* Im1D = Var1D + CUBE(FLU_NXT);

   real PhysicalMass = 0, ExtensionMass = 0;
   int  PhysicalCellCount = 0, ExtensionCellCount = 0;

   flag_spectral_complex_type Psi, Al, Ar;
   flag_spectral_complex_type Ae[FLAG_SPECTRAL_ORDER];
   flag_spectral_complex_type Ao[FLAG_SPECTRAL_ORDER];
   complex_type Row[FLU_NXT];

// iterate over 3 dimensions and sample the physical 2D arrays with a stride
// for FLU_NXT = 32, FLU_GHOST_SIZE = 8, Stride = 4, compute (16 / 4)^3 = 64 extensions
   for (size_t XYZ = 0; XYZ < 3; ++XYZ)
   for (size_t k=FLU_GHOST_SIZE; k<FLU_NXT-FLU_GHOST_SIZE; k+=Stride)
   for (size_t j=FLU_GHOST_SIZE; j<FLU_NXT-FLU_GHOST_SIZE; j+=Stride)
   {
//    read one column of data from 3D block
      for (size_t i = 0; i < FLU_NXT; ++i) {
         size_t index;

         switch (XYZ)
         {
            case 0:
               index = IDX321(k, j, i, FLU_NXT, FLU_NXT);
               break;
            case 1:
               index = IDX321(k, i, j, FLU_NXT, FLU_NXT);
               break;
            case 2:
               index = IDX321(i, k, j, FLU_NXT, FLU_NXT);
               break;
         }

         const real Re = Re1D[index];
         const real Im = Im1D[index];

         Row[i] = {Re, Im};

         PhysicalMass      += SQR(Re) + SQR(Im);
         PhysicalCellCount += 1;
      }

      for (int i = 0; i < FLAG_SPECTRAL_ORDER; ++i)
      {
         Al = {0, 0};
         Ar = {0, 0};
         for (int t = 0; t < FLAG_SPECTRAL_NDELTA; t++) {
            Al += Flag_Spectral_Pl[i][t] * (flag_spectral_complex_type) Row[t];                                  // left boundary
            Ar += Flag_Spectral_Pr[i][t] * (flag_spectral_complex_type) Row[FLU_NXT - FLAG_SPECTRAL_NDELTA + t]; // right boundary
         } // t

         Ae[i] = (flag_spectral_float) 0.5 * (Ar + Al);
         Ao[i] = (flag_spectral_float) 0.5 * (Ar - Al);
      }

      for ( int i = 0; i < FLAG_SPECTRAL_ND; ++i)
      {
         Psi = {0, 0};

         for (int order=0; order < FLAG_SPECTRAL_ORDER; order++) {
            Psi += Ae[order] *  Flag_Spectral_Fe[order][i];
            Psi += Ao[order] *  Flag_Spectral_Fo[order][i];
         }

         ExtensionMass      += SQR(Psi.real()) + SQR(Psi.imag());
         ExtensionCellCount += 1;
      }
   } // XYZ, k,j

// compute average density ratio
// add to safeguard against vanishing density
// should not trigger refinement for vanishing physical density and therefore be much bigger than the typical refinement thresholds
   const real Eps = 1e-4;
// divide by a typical mass ratio at which one might want to refine in order to make
// values in Input__Flag_Spectral look more reasonable
   const real Normalise = 1.0e18;

// compute average densities from masses to be independent of patch and extension sizes
   if ( PhysicalCellCount > 0 ) PhysicalMass /= PhysicalCellCount;
   if ( ExtensionCellCount > 0 ) ExtensionMass /= ExtensionCellCount;

   Cond = (ExtensionMass / (PhysicalMass + Eps )) / (Normalise);

} // FUNCTION : Flag_Spectral_Prepare_for_Spectral_Criterion



#endif // #if ( MODEL == ELBDM )
